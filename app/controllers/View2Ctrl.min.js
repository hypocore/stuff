/*! angular-seed 2017-05-30 */

"use strict";angular.module("myApp.view2").controller("View2Ctrl",["$scope","$rootScope","$http","$timeout","$q","portFactory","shipFactory",function(t,e,o,a,n,r,i){function c(t){i.getShipWealth()>t.unitPrice&&(i.subtractShipWealth(t.unitPrice),q.shipWealth=i.getShipWealth(),r.addPortWealth(t.unitPrice),q.portWealth=r.getPortWealth(),t.quantity-=1)}function s(t){r.getPortWealth()>t.unitPrice&&(r.subtractPortWealth(t.unitPrice),q.portWealth=r.getPortWealth(),i.addShipWealth(t.unitPrice),q.shipWealth=i.getShipWealth(),t.quantity+=1)}function u(t){w=a(function(){t.quantity+=1},1e3)}function l(t){t.quantity+=r.generateRandom(10)}function h(){t.$broadcast("newStuff",3)}function d(){e.$broadcast("rootMessage",4)}function g(){var t={name:q.newProduct.name,unitPrice:parseInt(q.newProduct.unitPrice),quantity:parseInt(q.newProduct.quantity),legal:q.newProduct.legal};q.localgoods.push(t),q.newProduct.name="",q.newProduct.unitPrice="",q.newProduct.quantity="",q.newProduct.legal=!1}function p(){r.sayHi(),q.controllerMessage=r.message}function P(){q.controllerMessageTwo=r.returnHey()}function W(t){r.randomizeGoods(t)}function f(){b.then(null,null,function(t){q.safeWeather=t})}function y(){S.notify(!1)}function m(){r.setPortGoods(),r.setPortWealth(),i.setShipWealth(100),q.localgoods=r.getPortGoods(),q.portWealth=r.getPortWealth(),q.shipWealth=i.getShipWealth(),t.$on("signal",function(){q.messages+=1})}var w,S=n.defer(),b=S.promise,q=this;angular.extend(q,{localgoods:{},name:[],price:[],messages:0,backendStatus:void 0,controllerMessage:"",controllerMessageTwo:"",showCheats:!1,portWealth:0,shipWealth:0,safeWeather:!0,buyProduct:c,sellProduct:s,addProduct:g,produceGoods:u,produceRandomGoods:l,broadcastMessage:h,broadcastRootscopeMsg:d,getFactoryToSayHi:p,getFactoryToReturnHey:P,setRandomGoods:W,checkSafeWeather:f,reportWeather:y,init:m}),q.init()}]);